{"ast":null,"code":"var _jsxFileName = \"/Users/subramani.p/Documents/Medimine/medimine-frontend/src/components/UploadForm.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport { config } from '../config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UploadForm = ({\n  onNewUpload\n}) => {\n  _s();\n  const [file, setFile] = useState(null);\n  const [isUploading, setIsUploading] = useState(false);\n  const [error, setError] = useState('');\n  const handleFileChange = e => {\n    setFile(e.target.files[0]);\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!file) {\n      setError('Please select a file to upload.');\n      return;\n    }\n    setIsUploading(true);\n    setError('');\n    try {\n      // 1. Get a pre-signed URL from our API\n      const presignedUrlResponse = await axios.post(`${config.API_URL}/presigned-url`, {\n        filename: file.name\n      });\n      const {\n        uploadUrl,\n        documentId\n      } = presignedUrlResponse.data;\n\n      // 2. Create a placeholder document to show in the UI immediately\n      const newDoc = {\n        documentId: documentId,\n        'brainstomers-01': documentId,\n        // To match your DynamoDB PK\n        filename: file.name,\n        status: 'Uploading...',\n        createdAt: Math.floor(Date.now() / 1000)\n      };\n      onNewUpload(newDoc); // Pass it to the Dashboard\n\n      // 3. Upload the file directly to S3 using the pre-signed URL\n      await axios.put(uploadUrl, file, {\n        headers: {\n          'Content-Type': file.type\n        }\n      });\n\n      // The S3 trigger will now automatically start the backend process.\n      // The WebSocket will handle updating the status from 'Uploading...' to 'Processing' and then 'Complete'.\n    } catch (err) {\n      console.error('Upload failed:', err);\n      setError('File upload failed. Please try again.');\n    } finally {\n      setIsUploading(false);\n      setFile(null);\n      e.target.reset(); // Clear the file input\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"upload-form-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Upload a New Document\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        onChange: handleFileChange,\n        accept: \".pdf,.docx\",\n        disabled: isUploading\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        disabled: isUploading,\n        children: isUploading ? 'Uploading...' : 'Upload & Analyze'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"error-message\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 9\n  }, this);\n};\n_s(UploadForm, \"LOuTmSv2Kfyk0kG5yL01D6HG8GY=\");\n_c = UploadForm;\nexport default UploadForm;\nvar _c;\n$RefreshReg$(_c, \"UploadForm\");","map":{"version":3,"names":["React","useState","axios","config","jsxDEV","_jsxDEV","UploadForm","onNewUpload","_s","file","setFile","isUploading","setIsUploading","error","setError","handleFileChange","e","target","files","handleSubmit","preventDefault","presignedUrlResponse","post","API_URL","filename","name","uploadUrl","documentId","data","newDoc","status","createdAt","Math","floor","Date","now","put","headers","type","err","console","reset","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","onChange","accept","disabled","_c","$RefreshReg$"],"sources":["/Users/subramani.p/Documents/Medimine/medimine-frontend/src/components/UploadForm.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport { config } from '../config';\n\nconst UploadForm = ({ onNewUpload }) => {\n    const [file, setFile] = useState(null);\n    const [isUploading, setIsUploading] = useState(false);\n    const [error, setError] = useState('');\n\n    const handleFileChange = (e) => {\n        setFile(e.target.files[0]);\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        if (!file) {\n            setError('Please select a file to upload.');\n            return;\n        }\n\n        setIsUploading(true);\n        setError('');\n\n        try {\n            // 1. Get a pre-signed URL from our API\n            const presignedUrlResponse = await axios.post(`${config.API_URL}/presigned-url`, {\n                filename: file.name\n            });\n\n            const { uploadUrl, documentId } = presignedUrlResponse.data;\n\n            // 2. Create a placeholder document to show in the UI immediately\n            const newDoc = {\n                documentId: documentId,\n                'brainstomers-01': documentId, // To match your DynamoDB PK\n                filename: file.name,\n                status: 'Uploading...',\n                createdAt: Math.floor(Date.now() / 1000)\n            };\n            onNewUpload(newDoc); // Pass it to the Dashboard\n\n            // 3. Upload the file directly to S3 using the pre-signed URL\n            await axios.put(uploadUrl, file, {\n                headers: { 'Content-Type': file.type }\n            });\n\n            // The S3 trigger will now automatically start the backend process.\n            // The WebSocket will handle updating the status from 'Uploading...' to 'Processing' and then 'Complete'.\n\n        } catch (err) {\n            console.error('Upload failed:', err);\n            setError('File upload failed. Please try again.');\n        } finally {\n            setIsUploading(false);\n            setFile(null);\n            e.target.reset(); // Clear the file input\n        }\n    };\n\n    return (\n        <div className=\"upload-form-container\">\n            <h3>Upload a New Document</h3>\n            <form onSubmit={handleSubmit}>\n                <input type=\"file\" onChange={handleFileChange} accept=\".pdf,.docx\" disabled={isUploading} />\n                <button type=\"submit\" disabled={isUploading}>\n                    {isUploading ? 'Uploading...' : 'Upload & Analyze'}\n                </button>\n            </form>\n            {error && <p className=\"error-message\">{error}</p>}\n        </div>\n    );\n};\n\nexport default UploadForm;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,MAAM,QAAQ,WAAW;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnC,MAAMC,UAAU,GAAGA,CAAC;EAAEC;AAAY,CAAC,KAAK;EAAAC,EAAA;EACpC,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGT,QAAQ,CAAC,IAAI,CAAC;EACtC,MAAM,CAACU,WAAW,EAAEC,cAAc,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACY,KAAK,EAAEC,QAAQ,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAEtC,MAAMc,gBAAgB,GAAIC,CAAC,IAAK;IAC5BN,OAAO,CAACM,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC;EAC9B,CAAC;EAED,MAAMC,YAAY,GAAG,MAAOH,CAAC,IAAK;IAC9BA,CAAC,CAACI,cAAc,CAAC,CAAC;IAClB,IAAI,CAACX,IAAI,EAAE;MACPK,QAAQ,CAAC,iCAAiC,CAAC;MAC3C;IACJ;IAEAF,cAAc,CAAC,IAAI,CAAC;IACpBE,QAAQ,CAAC,EAAE,CAAC;IAEZ,IAAI;MACA;MACA,MAAMO,oBAAoB,GAAG,MAAMnB,KAAK,CAACoB,IAAI,CAAC,GAAGnB,MAAM,CAACoB,OAAO,gBAAgB,EAAE;QAC7EC,QAAQ,EAAEf,IAAI,CAACgB;MACnB,CAAC,CAAC;MAEF,MAAM;QAAEC,SAAS;QAAEC;MAAW,CAAC,GAAGN,oBAAoB,CAACO,IAAI;;MAE3D;MACA,MAAMC,MAAM,GAAG;QACXF,UAAU,EAAEA,UAAU;QACtB,iBAAiB,EAAEA,UAAU;QAAE;QAC/BH,QAAQ,EAAEf,IAAI,CAACgB,IAAI;QACnBK,MAAM,EAAE,cAAc;QACtBC,SAAS,EAAEC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;MAC3C,CAAC;MACD5B,WAAW,CAACsB,MAAM,CAAC,CAAC,CAAC;;MAErB;MACA,MAAM3B,KAAK,CAACkC,GAAG,CAACV,SAAS,EAAEjB,IAAI,EAAE;QAC7B4B,OAAO,EAAE;UAAE,cAAc,EAAE5B,IAAI,CAAC6B;QAAK;MACzC,CAAC,CAAC;;MAEF;MACA;IAEJ,CAAC,CAAC,OAAOC,GAAG,EAAE;MACVC,OAAO,CAAC3B,KAAK,CAAC,gBAAgB,EAAE0B,GAAG,CAAC;MACpCzB,QAAQ,CAAC,uCAAuC,CAAC;IACrD,CAAC,SAAS;MACNF,cAAc,CAAC,KAAK,CAAC;MACrBF,OAAO,CAAC,IAAI,CAAC;MACbM,CAAC,CAACC,MAAM,CAACwB,KAAK,CAAC,CAAC,CAAC,CAAC;IACtB;EACJ,CAAC;EAED,oBACIpC,OAAA;IAAKqC,SAAS,EAAC,uBAAuB;IAAAC,QAAA,gBAClCtC,OAAA;MAAAsC,QAAA,EAAI;IAAqB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC9B1C,OAAA;MAAM2C,QAAQ,EAAE7B,YAAa;MAAAwB,QAAA,gBACzBtC,OAAA;QAAOiC,IAAI,EAAC,MAAM;QAACW,QAAQ,EAAElC,gBAAiB;QAACmC,MAAM,EAAC,YAAY;QAACC,QAAQ,EAAExC;MAAY;QAAAiC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC5F1C,OAAA;QAAQiC,IAAI,EAAC,QAAQ;QAACa,QAAQ,EAAExC,WAAY;QAAAgC,QAAA,EACvChC,WAAW,GAAG,cAAc,GAAG;MAAkB;QAAAiC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC9C,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACP,CAAC,EACNlC,KAAK,iBAAIR,OAAA;MAAGqC,SAAS,EAAC,eAAe;MAAAC,QAAA,EAAE9B;IAAK;MAAA+B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACjD,CAAC;AAEd,CAAC;AAACvC,EAAA,CAnEIF,UAAU;AAAA8C,EAAA,GAAV9C,UAAU;AAqEhB,eAAeA,UAAU;AAAC,IAAA8C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}